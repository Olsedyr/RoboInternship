VERSION 2
SUB 308
COUNTER restart += 1
GOTO testB
 LABEL testA
SLEEP 100
TESTEVENT Pallebane4 ST_READY_ROBOT
SUB sektion4ready
 TESTEVENT PalletAWatch ST_DIRTY
 SUB dirty
   COUNTER cAPallet += 1
   COUNTER cAItems = sAItems
   RESETPRELOAD 0
   SIGNALEVENT 1 PalletAWatch ST_CLEAN	
 END  
 TESTEVENT PladsLoad ST_EMPTY
 SUB ConveyorInready
  LABEL offlineA
  COUNTER cAItems == 0
  SUB path21
   PPSCRIPT 308C18In idx=0,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 1
  SUB path20
   PPSCRIPT 308C18In idx=1,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 2
  SUB path19
   PPSCRIPT 308C18In idx=2,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 3
  SUB path18
   PPSCRIPT 308C18In idx=3,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 4
  SUB path17
   PPSCRIPT 308C18In idx=4,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 5
  SUB path16
   PPSCRIPT 308C18In idx=5,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 6
  SUB path15
   PPSCRIPT 308C18In idx=6,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 7
  SUB path14
   PPSCRIPT 308C18In idx=7,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 8
  SUB path13
   PPSCRIPT 308C18In idx=8,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 9
  SUB path12
   PPSCRIPT 308C18In idx=9,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 10
  SUB path11
   PPSCRIPT 308C18In idx=10,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 11
  SUB path10
   PPSCRIPT 308C18In idx=11,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 12
  SUB path9
   PPSCRIPT 308C18In idx=12,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 13
  SUB path8
   PPSCRIPT 308C18In idx=13,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 14
  SUB path7
   PPSCRIPT 308C18In idx=14,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 15
  SUB path6
   PPSCRIPT 308C18In idx=15,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 16
  SUB path5
   PPSCRIPT 308C18In idx=16,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 17
  SUB path4
   PPSCRIPT 308C18In idx=17,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 18
  SUB path3
   PPSCRIPT 308C18In idx=18,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 19
  SUB path2
   PPSCRIPT 308C18In idx=19,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 20
  SUB path1
   PPSCRIPT 308C18In idx=20,loadgroup=0
   GOTO afterEachPathA
  END
  COUNTER cAItems == 21
  SUB path0
   PPSCRIPT 308C18In idx=21,loadgroup=0
   GOTO afterEachPathA
  END
* if no pathA found goto to next group
*  GOTO testB
LABEL afterEachPathA
  COUNTER cAItems >= wAItems
  SUB
*   COUNTER cAPallet += 1
*   COUNTER cAItems = sAItems
*   RESETPRELOAD 0
   SIGNALEVENT 1 Pallebane4 ST_RESET
  END
 END
END
LABEL testB
SLEEP 100
TESTEVENT Pallebane6 ST_OK
SUB sektion6ok
  COUNTER restart > 1
  SUB
    COUNTER cBItems >= wBItems
    SUB PalleUd
      GOTO afterEachPathB
    END
    COUNTER cBItems == sBItems
    SUB
      SIGNALEVENT 1 Pallebane6 ST_READY
      GOTO testReadyRobot
    END
    SIGNALEVENT 1 Pallebane6 ST_READY_ROBOT
    GOTO testReadyRobot
  END
  SIGNALEVENT 1 Pallebane6 ST_READY
END
LABEL testReadyRobot
TESTEVENT Pallebane6 ST_READY_ROBOT
SUB sektion6readyRobot
 COUNTER cBItems >= wBItems
 SUB PalleUd
   COUNTER cBItems = sBItems
   RESETPRELOAD 1
   SIGNALEVENT 1 Pallebane6 ST_READY
   GOTO testA
 END
 TESTEVENT ConveyorOut ST_WAIT3
 SUB ConveyorOutOK
   GOTO offlineB
 END
 TESTEVENT ConveyorOut ST_READY_ROBOT
 SUB sektion36ready
  LABEL offlineB
  COUNTER cBItems == 0
  SUB path0
   PPSCRIPT 308C18Out idx=0,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 1
  SUB path1
   PPSCRIPT 308C18Out idx=1,loadgroup=1
   GOTO afterEachPathB
  END 
  COUNTER cBItems == 2
  SUB path2
   PPSCRIPT 308C18Out idx=2,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 3
  SUB path3
   PPSCRIPT 308C18Out idx=3,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 4
  SUB path4
   PPSCRIPT 308C18Out idx=4,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 5
  SUB path5
   PPSCRIPT 308C18Out idx=5,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 6
  SUB path6
   PPSCRIPT 308C18Out idx=6,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 7
  SUB path7
   PPSCRIPT 308C18Out idx=7,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 8
  SUB path8
   PPSCRIPT 308C18Out idx=8,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 9
  SUB path9
   PPSCRIPT 308C18Out idx=9,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 10
  SUB path10
   PPSCRIPT 308C18Out idx=10,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 11
  SUB path11
   PPSCRIPT 308C18Out idx=11,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 12
  SUB path12
   PPSCRIPT 308C18Out idx=12,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 13
  SUB path13
   PPSCRIPT 308C18Out idx=13,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 14
  SUB path14
   PPSCRIPT 308C18Out idx=14,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 15
  SUB path15
   PPSCRIPT 308C18Out idx=15,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 16
  SUB path16
   PPSCRIPT 308C18Out idx=16,loadgroup=1
   GOTO afterEachPathB
  END
  COUNTER cBItems == 17
  SUB path17
   PPSCRIPT 308C18Out idx=17,loadgroup=1
   GOTO afterEachPathB
  END
  GOTO testA
LABEL afterEachPathB
  COUNTER cBItems >= wBItems
  SUB
   COUNTER cBPallet += 1
   COUNTER cBItems = sBItems
   RESETPRELOAD 1
   SIGNALEVENT 1 Pallebane6 ST_READY
  END
 END
END
GOTO testA
END

