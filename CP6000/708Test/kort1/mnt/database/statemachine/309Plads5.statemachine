STATEMACHINEVERSION 2
Name=Plads5
Delaystop=7000000
Input=0,Foto "ConveyorIn Foto5"
Input=1,Skubberout "ConveyorIn kasseSkubber+"
Input=2,Skubberin "ConveyorIn kasseSkubber-"
Input=3,Endestop "ConveyorIn endestop"
Input=4,FotoManIn "ConveyorManuelIn foto1"
Output=0,Skubout "ConveyorIn kasseSkubberUd"
Link=0,KassePakkerBottom
Link=1,ConveyorManuelIn
Link=2,CInFotoFive
Timeout=0,PushDelay 2100000
Timeout=1,TimeManuel 500000
Timeout=2,sendTimeout 3000000

State=0,ST_TIMER
END

State=0,ST_HALT
END

State=0,ST_IDLE
  SET Skubout 0 
END

State=1,ST_READY
  TEST KassePakkerBottom = ST_EMPTY
    SET Skubout 1
    TIMEOUT PushDelay ST_SEND_FW
    SETSTATE ST_SEND_FW
  ELSE
    TEST KassePakkerBottom = ST_IDLE
      SETSTATE ST_IDLE
    ENDTEST
  ENDTEST
END

State=2,ST_EMPTY
  TEST CInFotoFive = ST_HIGH
    SETSTATE ST_READY
  ELSE
    TEST KassePakkerBottom = ST_IDLE
      SETSTATE ST_IDLE
    ENDTEST
  ENDTEST
END

State=3,ST_SEND_FW
  TEST PushDelay = 1
  OR Skubberout = 1
    SET Skubout 0
    SETSTATE ST_SEND_BACK
  ENDTEST
END

State=4,ST_SEND_BACK
  TEST Skubberin = 1
    SET Skubout 0
    SETSTATE ST_EMPTY
  ENDTEST
END

State=5,ST_RESET
  TEST Endestop = 0
    TEST Foto = 1
      SETSTATE ST_READY
    ELSE
      TEST Skubberin = 0
        SET Skubout 0
        SETSTATE ST_SEND_BACK
      ELSE
        SETSTATE ST_EMPTY
      ENDTEST
    ENDTEST
  ELSE
    TEST Foto = 1
      SETSTATE ST_READYMANUEL
    ELSE
      SETSTATE ST_EMPTYMANUEL
    ENDTEST
  ENDTEST
END

State=5,ST_READYMANUEL
  TEST FotoManIn = 1
    TIMEOUT sendTimeout ST_SENDMANUEL
    SETSTATE ST_SENDMANUEL
  ENDTEST
  TEST KassePakkerBottom = ST_IDLE
    SETSTATE ST_IDLE
  ENDTEST
END

State=5,ST_EMPTYMANUEL
  TEST Foto = 1
    SETSTATE ST_READYMANUEL
  ELSE
    TEST KassePakkerBottom = ST_IDLE
      SETSTATE ST_IDLE
    ENDTEST
  ENDTEST
END

State=5,ST_SENDMANUEL
  TEST FotoManIn = 0
    SETSTATE ST_EMPTYMANUEL
  ELSE
    TEST sendTimeout = 1
      SETSTATE ST_RESET
    ENDTEST
  ENDTEST
END
