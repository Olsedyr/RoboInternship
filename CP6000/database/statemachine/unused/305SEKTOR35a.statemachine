STATEMACHINEVERSION 2
Name=Sektor35a
Delaystop=10000000
Input=0,Foto1 "Sektor35a Foto1" 
Output=0,Motor "Sektor35a Motor"
Link=0,Sektor35b
Link=1,Sektor22
Link=2,Sektor34
Timeout=0,StopDelay 1000000
Timeout=1,ShiftDelay 1000000
State=0,ST_HALT
  END

State=0,ST_TIMER
  END


State=0,ST_IDLE
  SET Motor 0
  END

State=1,ST_READY
  TEST Foto1 = 0
    SETSTATE ST_EMPTY
  ELSE 
    TEST Sektor35b = ST_EMPTY
    OR Sektor35b = ST_RECIEVE
      SETSTATE ST_SEND
    ELSE
      TEST Sektor35b = ST_SEND
        SET Motor 1
      ELSE
        SET Motor 0
      ENDTEST
    ENDTEST
  ENDTEST
  TEST Sektor34 = ST_IDLE
  AND Sektor22 = ST_IDLE
    SETSTATE ST_IDLE
  ENDTEST
  END

State=2,ST_SEND
  TEST Foto1 = 0
    TIMEOUT StopDelay ST_EMPTY
    SETSTATE ST_TIMER
  ELSE 
    SET Motor 1
 ENDTEST
 END

State=3,ST_EMPTY
  TEST Foto1 = 1 
    SETSTATE ST_READY
  ELSE 
    TEST Sektor22 = ST_SHIFT_RIGHT
    OR Sektor22 = ST_PUSH_SHIFT_RIGHT
      SETSTATE ST_EMPTY_SHIFT
    ELSE 
      TEST Sektor35b = ST_SEND
        SET Motor 1
      ELSE 
        TEST Sektor34 = ST_READY
        OR Sektor34 = ST_SEND
          SETSTATE ST_RECIEVE 
        ELSE
          SET Motor 0
        ENDTEST
      ENDTEST
    ENDTEST
 ENDTEST
  TEST Sektor34 = ST_IDLE
  AND Sektor22 = ST_IDLE
    SETSTATE ST_IDLE
  ENDTEST
 END

State=4,ST_EMPTY_SHIFT
  TEST Foto1 = 1
    TIMEOUT ShiftDelay ST_READY
    SETSTATE ST_TIMER
  ENDTEST
  TEST Sektor22 = ST_PUSH_SHIFT_RIGHT
      SETSTATE ST_RECIEVE_SHIFT
  ENDTEST
  END

State=5,ST_RECIEVE
  TEST Foto1 = 1 
    SETSTATE ST_READY
  ELSE
    SET Motor 1
  ENDTEST
  END

State=6,ST_RECIEVE_SHIFT
  TEST Foto1 = 1
    SETSTATE ST_READY_SHIFT
  ENDTEST
  END

State=7,ST_READY_SHIFT
  TEST Foto1 = 1
    TEST Sektor22 = ST_EMPTY
      SETSTATE ST_READY
    ENDTEST
  ELSE 
    SETSTATE ST_RESET
  ENDTEST
  END

State=8,ST_RESET
  TEST Foto1 = 1
   SETSTATE ST_READY
 ELSE 
   SETSTATE ST_EMPTY
 ENDTEST
 END
