STATEMACHINEVERSION 3
Name=ConveyorParent
Link=CP1 KasseInLiner
Link=CP2 KasseInLiner2
Link=CP3 KasseInLinerPrevBack3
Link=CM KasseStativ
Link=Robot ConveyorOut
;convcon on 801:
Link=convcon ConveyorControl

State=ST_HALT
  SETSTATE ST_IDLE
END

State=ST_TIMER
END

State=ST_IDLE
  TEST convcon = ST_RUN
    TEST CP1 != ST_IDLE
    AND CP1 != ST_HALT
    AND CP1 != UNKNOWN
      SETSTATE ST_RESET
    ENDTEST
    TEST CP2 != ST_IDLE
    AND CP2 != ST_HALT
    AND CP2 != UNKNOWN
      SETSTATE ST_RESET
    ENDTEST
    TEST CP3 != ST_IDLE
    AND CP3 != ST_HALT
    AND CP3 != UNKNOWN
      SETSTATE ST_RESET
    ENDTEST
    TEST CM != ST_IDLE
    AND CM != ST_HALT
    AND CM != UNKNOWN
      SETSTATE ST_RESET
    ENDTEST
    TEST Robot != ST_IDLE
    AND Robot != ST_HALT
    AND Robot != UNKNOWN
      SETSTATE ST_RESET
    ENDTEST
  ENDTEST
  TEST convcon = ST_ALWAYS_RUN
    SETSTATE ST_RESET
  ENDTEST
END

State=ST_RUN
  TEST convcon = ST_IDLE
  OR convcon = UNKNOWN
    SETSTATE ST_IDLE
  ELSE
    TEST convcon = ST_RUN
      TEST CP1 = ST_IDLE
      OR CP1 = ST_HALT
      OR CP1 = UNKNOWN
        TEST CP2 = ST_IDLE
        OR CP2 = ST_HALT
        OR CP2 = UNKNOWN
          TEST CP3 = ST_IDLE
          OR CP3 = ST_HALT
          OR CP3 = UNKNOWN
            TEST CM = ST_IDLE
            OR CM = ST_HALT
            OR CM = UNKNOWN
              TEST Robot = ST_IDLE
              OR Robot = ST_HALT
              OR Robot = UNKNOWN
                SETSTATE ST_IDLE
              ENDTEST 
            ENDTEST
          ENDTEST
        ENDTEST
      ENDTEST
    ENDTEST
  ENDTEST
END

State=ST_RESET
  SETSTATE ST_RUN
END
